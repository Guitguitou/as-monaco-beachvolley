<div class="space-y-6">
  <!-- KPIs Cards -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Revenus -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
        <%= lucide_icon('euro', class: 'w-5 h-5 mr-2 text-green-600') %>
        Chiffre d'Affaires
      </h3>
      <div class="space-y-4">
        <% revenue_cards.each do |card| %>
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <div class="<%= card_color_classes(card[:color]) %> rounded-lg p-2 mr-3">
                <%= lucide_icon(card[:icon], class: 'w-4 h-4') %>
              </div>
              <span class="text-sm font-medium text-gray-600"><%= card[:title] %></span>
            </div>
            <span class="text-lg font-bold text-gray-900"><%= format_currency(card[:value]) %> €</span>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Salaires -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
        <%= lucide_icon('users', class: 'w-5 h-5 mr-2 text-orange-600') %>
        Salaires Coachs
      </h3>
      <div class="space-y-4">
        <% salary_cards.each do |card| %>
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <div class="<%= card_color_classes(card[:color]) %> rounded-lg p-2 mr-3">
                <%= lucide_icon(card[:icon], class: 'w-4 h-4') %>
              </div>
              <span class="text-sm font-medium text-gray-600"><%= card[:title] %></span>
            </div>
            <span class="text-lg font-bold text-gray-900"><%= format_currency(card[:value]) %> €</span>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Bénéfices -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
        <%= lucide_icon('trending-up', class: 'w-5 h-5 mr-2 text-blue-600') %>
        Bénéfices
      </h3>
      <div class="space-y-4">
        <% profit_cards.each do |card| %>
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <div class="<%= card_color_classes(card[:color]) %> rounded-lg p-2 mr-3">
                <%= lucide_icon(card[:icon], class: 'w-4 h-4') %>
              </div>
              <span class="text-sm font-medium text-gray-600"><%= card[:title] %></span>
            </div>
            <span class="text-lg font-bold <%= card[:color] == 'green' ? 'text-green-600' : 'text-red-600' %>">
              <%= format_currency(card[:value]) %> €
            </span>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Breakdown par type d'achat -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Sessions -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
      <div class="px-4 py-3 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-900">Revenus par type de session</h3>
      </div>
      <div class="p-4">
        <div class="space-y-3">
          <% breakdowns[:sessions].each do |type, amount| %>
            <div class="flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0">
              <span class="text-sm font-medium text-gray-900"><%= type.humanize %></span>
              <span class="text-sm font-bold text-gray-900"><%= format_currency(amount) %> €</span>
            </div>
          <% end %>
          <div class="flex items-center justify-between py-2 border-t-2 border-gray-200 font-bold">
            <span class="text-sm text-gray-900">Total Sessions</span>
            <span class="text-sm text-gray-900"><%= format_currency(breakdowns[:sessions].values.sum) %> €</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Packs -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
      <div class="px-4 py-3 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-900">Revenus par type de pack</h3>
      </div>
      <div class="p-4">
        <div class="space-y-3">
          <% breakdowns[:packs].each do |type, amount| %>
            <div class="flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0">
              <span class="text-sm font-medium text-gray-900"><%= type.humanize %></span>
              <span class="text-sm font-bold text-gray-900"><%= format_currency(amount) %> €</span>
            </div>
          <% end %>
          <div class="flex items-center justify-between py-2 border-t-2 border-gray-200 font-bold">
            <span class="text-sm text-gray-900">Total Packs</span>
            <span class="text-sm text-gray-900"><%= format_currency(breakdowns[:packs].values.sum) %> €</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tableau récapitulatif -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200">
    <div class="px-4 py-3 border-b border-gray-200">
      <h3 class="text-lg font-semibold text-gray-900">Récapitulatif financier</h3>
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Période</th>
            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">CA (€)</th>
            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Salaires (€)</th>
            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Bénéfice (€)</th>
            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Marge (%)</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr>
            <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Semaine</td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900"><%= format_currency(revenues[:week]) %></td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900"><%= format_currency(coach_salaries[:week]) %></td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right font-bold <%= revenues[:week] - coach_salaries[:week] >= 0 ? 'text-green-600' : 'text-red-600' %>">
              <%= format_currency(revenues[:week] - coach_salaries[:week]) %>
            </td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900">
              <%= revenues[:week] > 0 ? number_with_precision((revenues[:week] - coach_salaries[:week]) / revenues[:week] * 100, precision: 1) : 0 %>%
            </td>
          </tr>
          <tr>
            <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Mois</td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900"><%= format_currency(revenues[:month]) %></td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900"><%= format_currency(coach_salaries[:month]) %></td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right font-bold <%= revenues[:month] - coach_salaries[:month] >= 0 ? 'text-green-600' : 'text-red-600' %>">
              <%= format_currency(revenues[:month] - coach_salaries[:month]) %>
            </td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900">
              <%= revenues[:month] > 0 ? number_with_precision((revenues[:month] - coach_salaries[:month]) / revenues[:month] * 100, precision: 1) : 0 %>%
            </td>
          </tr>
          <tr>
            <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Année</td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900"><%= format_currency(revenues[:year]) %></td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900"><%= format_currency(coach_salaries[:year]) %></td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right font-bold <%= revenues[:year] - coach_salaries[:year] >= 0 ? 'text-green-600' : 'text-red-600' %>">
              <%= format_currency(revenues[:year] - coach_salaries[:year]) %>
            </td>
            <td class="px-4 py-4 whitespace-nowrap text-sm text-right text-gray-900">
              <%= revenues[:year] > 0 ? number_with_precision((revenues[:year] - coach_salaries[:year]) / revenues[:year] * 100, precision: 1) : 0 %>%
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
