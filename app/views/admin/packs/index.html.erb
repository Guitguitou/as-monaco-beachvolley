<%= render Admin::PageComponent.new(title: "Gestion des Packs", icon: "package") do |page| %>
  <% page.with_actions do %>
    <%= button "Nouveau pack",
          variant: :primary,
          href: new_admin_pack_path,
          icon: :plus %>
  <% end %>

  <%= render Admin::TableComponent.new do %>
    <table class="min-w-full divide-y divide-gray-200 bg-white text-sm table-fixed">
    <thead class="bg-gray-50 text-gray-600 uppercase text-xs tracking-wide">
      <tr>
        <th class="px-4 sm:px-6 py-3 text-left">Nom</th>
        <th class="px-4 sm:px-6 py-3 text-left hidden sm:table-cell">Type</th>
        <th class="px-4 sm:px-6 py-3 text-left">Montant</th>
        <th class="px-4 sm:px-6 py-3 text-left hidden md:table-cell">Crédits</th>
        <th class="px-4 sm:px-6 py-3 text-left hidden lg:table-cell">Stage</th>
        <th class="px-4 sm:px-6 py-3 text-left hidden xl:table-cell">Position</th>
        <th class="px-4 sm:px-6 py-3 text-left">Statut</th>
        <th class="px-4 sm:px-6 py-3 text-right w-16 sm:w-24">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-100">
      <% @packs.each do |pack| %>
        <tr class="hover:bg-gray-50 transition-colors">
          <!-- Nom -->
          <td class="px-4 sm:px-6 py-4 font-medium text-gray-800">
            <%= pack.name %>
          </td>

          <!-- Type -->
          <td class="px-4 sm:px-6 py-4 hidden sm:table-cell">
            <% if pack.pack_type_credits? %>
              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-800 text-xs font-semibold">
                <%= lucide_icon("coins", size: 14) %> Crédits
              </span>
            <% elsif pack.pack_type_licence? %>
              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-green-100 text-green-800 text-xs font-semibold">
                <%= lucide_icon("badge-check", size: 14) %> Licence
              </span>
            <% else %>
              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-purple-100 text-purple-800 text-xs font-semibold">
                <%= lucide_icon("flag", size: 14) %> Stage
              </span>
            <% end %>
          </td>

          <!-- Montant -->
          <td class="px-4 sm:px-6 py-4 font-semibold text-gray-900">
            <%= number_to_currency(pack.amount_eur, unit: "€", precision: 2) %>
          </td>

          <!-- Crédits -->
          <td class="px-4 sm:px-6 py-4 text-gray-700 hidden md:table-cell">
            <% if pack.credits.present? %>
              <%= pack.credits %>
            <% else %>
              <span class="text-gray-400">–</span>
            <% end %>
          </td>

          <!-- Stage -->
          <td class="px-4 sm:px-6 py-4 text-gray-700 hidden lg:table-cell">
            <% if pack.stage.present? %>
              <span class="text-sm"><%= pack.stage.title %></span>
            <% else %>
              <span class="text-gray-400">–</span>
            <% end %>
          </td>

          <!-- Position -->
          <td class="px-4 sm:px-6 py-4 text-gray-700 hidden xl:table-cell">
            <%= pack.position %>
          </td>

          <!-- Statut -->
          <td class="px-4 sm:px-6 py-4">
            <% if pack.active? %>
              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-green-100 text-green-800 text-xs font-semibold">
                <%= lucide_icon("check-circle", size: 14) %> Actif
              </span>
            <% else %>
              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 text-gray-800 text-xs font-semibold">
                <%= lucide_icon("x-circle", size: 14) %> Inactif
              </span>
            <% end %>
          </td>

          <!-- Actions -->
          <td class="px-4 sm:px-6 py-4">
            <div class="flex items-center justify-end gap-2">
              <%= button "Modifier",
                    variant: :tertiary,
                    size: :small,
                    href: edit_admin_pack_path(pack),
                    icon: :edit,
                    icon_only: true %>
              <%= button "Supprimer",
                    variant: :tertiary,
                    size: :small,
                    href: admin_pack_path(pack),
                    icon: :delete,
                    icon_only: true,
                    data: { turbo_method: :delete, turbo_confirm: "Êtes-vous sûr de vouloir supprimer ce pack ?" } %>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
    </table>
  <% end %>

  <%= render Admin::PaginationComponent.new(
        current_page: @current_page,
        total_pages: @total_pages,
        params: params
      ) %>

  <% if @packs.empty? %>
    <div class="text-center py-12 bg-white border border-gray-200 mt-6">
      <div class="flex flex-col items-center gap-3">
        <%= lucide_icon("package", size: 48, class: "text-gray-300") %>
        <p class="text-gray-500 text-lg">Aucun pack pour le moment</p>
        <%= button "Créer le premier pack",
              variant: :primary,
              href: new_admin_pack_path,
              icon: :plus %>
      </div>
    </div>
  <% end %>
<% end %>
