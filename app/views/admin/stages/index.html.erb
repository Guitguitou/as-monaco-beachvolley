<%= render Admin::PageComponent.new(title: "Stages", icon: "flag") do |page| %>
  <% page.with_actions do %>
    <% if can?(:create, Stage) %>
      <%= button "Nouveau stage",
            variant: :primary,
            href: new_admin_stage_path,
            icon: :plus %>
    <% end %>
  <% end %>

  <%= render Admin::TableComponent.new do %>
    <table class="min-w-full divide-y divide-gray-200 bg-white text-sm table-fixed">
    <thead class="bg-gray-50 text-gray-600 uppercase text-xs tracking-wide">
      <tr>
        <th class="px-4 sm:px-6 py-3 text-left w-1/3">Titre</th>
        <th class="px-4 sm:px-6 py-3 text-left w-1/4">Dates</th>
        <th class="px-4 sm:px-6 py-3 text-left w-1/4">Coachs</th>
        <th class="px-4 sm:px-6 py-3 text-right w-16 sm:w-24">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-100">
      <% @stages.each do |stage| %>
        <tr class="hover:bg-gray-50 transition-colors">
          <td class="px-4 sm:px-6 py-4 whitespace-nowrap font-medium text-gray-800 flex items-center gap-2">
            <%= lucide_icon("flag", size: 16, class: "text-gray-500") %>
            <%= stage.title.presence || "(Sans titre)" %>
          </td>
          <td class="px-4 sm:px-6 py-4 text-gray-700">
            <%= l stage.starts_on, format: :default %> â€” <%= l stage.ends_on, format: :default %>
          </td>
          <td class="px-4 sm:px-6 py-4 text-gray-700">
            <%= [stage.main_coach&.full_name, stage.assistant_coach&.full_name].compact.join(" / ") %>
          </td>
          <td class="px-4 sm:px-6 py-4">
            <div class="flex items-center justify-end gap-2">
              <%= button "Voir",
                    variant: :tertiary,
                    size: :small,
                    href: admin_stage_path(stage),
                    icon: :eye,
                    icon_only: true %>
              <%= button "Modifier",
                    variant: :tertiary,
                    size: :small,
                    href: edit_admin_stage_path(stage),
                    icon: :edit,
                    icon_only: true %>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
    </table>
  <% end %>

  <%= render Admin::PaginationComponent.new(
        current_page: @current_page,
        total_pages: @total_pages,
        params: params
      ) %>
<% end %>
