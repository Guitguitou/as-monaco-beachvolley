<div class="max-w-4xl mx-auto mt-10 bg-white p-8 rounded-lg shadow-md">
  <% if session.errors.any? %>
    <div class="mb-6 rounded-md bg-red-50 p-4 border border-red-200">
      <h3 class="text-sm font-semibold text-red-800">Erreurs de validation</h3>
      <ul class="mt-2 text-sm text-red-700 list-disc list-inside">
        <% session.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with model: session, 
                url: session.persisted? ? session_path(session) : sessions_path, 
                method: session.persisted? ? :put : :post, 
                class: "space-y-12" do |f| %>

    <div class="border-b border-gray-200 pb-8">
      <h2 class="text-lg font-semibold text-gray-900">Informations de la session</h2>

      <div class="mt-8 grid grid-cols-1 gap-x-6 gap-y-6 sm:grid-cols-2">
        
        <!-- Titre -->
        <div class="sm:col-span-2">
          <%= f.label :title, "Titre", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.text_field :title, required: true, 
                class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                        placeholder:text-gray-400 focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <!-- Description -->
        <div class="sm:col-span-2">
          <%= f.label :description, "Description", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.text_area :description, rows: 3, 
                class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                        placeholder:text-gray-400 focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <!-- Type -->
        <div>
          <%= f.label :session_type, "Type de session", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.select :session_type, 
                  options_for_select(Session.session_types.keys.map { |t| [t.humanize, t] }, session.session_type),
                  {}, class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                              focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <!-- Terrain -->
        <div>
          <%= f.label :terrain, "Terrain", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.select :terrain, 
                  options_for_select(Session.terrains.keys, session.terrain),
                  {}, class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                              focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <!-- Coach -->
        <div class="sm:col-span-2">
          <%= f.label :user_id, "Organisateur / Coach / Responsable", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.select :user_id, 
                  options_from_collection_for_select(User.all, :id, :full_name, session.user_id),
                  {}, class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                              focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <!-- Dates -->
        <div>
          <%= f.label :start_at, "Date de dÃ©but", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.datetime_local_field :start_at, 
                  class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                          focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <div>
          <%= f.label :end_at, "Date de fin", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.datetime_local_field :end_at, 
                  class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                          focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <!-- Max joueurs -->
        <div>
          <%= f.label :max_players, "Nombre maximum de joueurs", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-2">
            <%= f.number_field :max_players, min: 1, 
                  class: "block w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-gray-900 
                          focus:border-asmbv-red focus:ring-2 focus:ring-asmbv-red sm:text-sm" %>
          </div>
        </div>

        <!-- Niveaux -->
        <div class="sm:col-span-2">
          <%= f.label :level_ids, "Niveaux", class: "block text-sm font-medium text-gray-900" %>
          <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2">
            <%= f.collection_check_boxes :level_ids, Level.all, :id, :name do |b| %>
              <div class="flex items-center">
                <%= b.check_box(class: "h-4 w-4 text-asmbv-red border-gray-300 rounded focus:ring-asmbv-red") %>
                <%= b.label(class: "ml-2 text-sm text-gray-700") do %>
                  <%= "#{b.object.name} - #{b.object.gender.humanize}" %>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>

      </div>
    </div>

    <!-- Bouton -->
    <div class="flex items-center justify-end gap-x-4">
      <%= link_to "Annuler", sessions_path, class: "text-sm font-medium text-gray-500 hover:text-gray-700" %>
      <%= f.submit "Enregistrer", 
            class: "inline-flex items-center rounded-md bg-asmbv-red px-4 py-2 text-sm font-semibold text-white shadow-sm 
                    hover:bg-asmbv-red-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-asmbv-red" %>
    </div>
  <% end %>
</div>
