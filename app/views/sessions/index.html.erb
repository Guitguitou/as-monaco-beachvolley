<div class="flex items-center justify-between mb-4 flex-col gap-3 sm:flex-row sm:gap-0">
  <h1 class="text-2xl font-bold flex items-center gap-2">
    <%= lucide_icon("calendar") %> Mon calendrier
  </h1>
  
  <div class="flex items-center gap-2 flex-wrap justify-end">
    <%= render "terrain_filter" %>
    <%= link_to new_session_path, class: "bg-asmbv-red hover:bg-asmbv-red-dark text-asmbv-red-light font-semibold rounded-md px-4 py-2 transition inline-flex items-center gap-2" do %>
      <%= lucide_icon("plus-circle", class: "w-5 h-5") %> Nouvelle session
    <% end if current_user.admin? %>
  </div>
</div>

<% sessions_json = @sessions.map { |s|
  {
    id: s.id,
    title: "#{s.display_name} - #{s.user&.full_name || '-'}",
    start: s.start_at.iso8601,
    end: s.end_at.iso8601,
    url: session_path(s),
    backgroundColor: s.levels.first&.color || '#E60012',
    textColor: '#fff',
    terrain: s.terrain
  }
}.to_json %>

<div
  id="calendar"
  data-controller="calendar"
  data-sessions="<%= json_escape(sessions_json) %>"
  class="mt-4 bg-white p-2 sm:p-4 min-h-[60vh] rounded-md">
</div>
