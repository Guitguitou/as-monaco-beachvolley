<div class="px-4 py-6">
  <!-- Header -->
  <div class="mb-8 text-center">
    <h1 class="text-3xl font-bold text-gray-900 mb-2 flex items-center justify-center gap-3">
      <%= lucide_icon("bar-chart-3", class: "w-8 h-8 text-asmbv-red") %>
      Performances & Stats
    </h1>
    <p class="text-gray-600 text-lg">Les badges qui font transpirer (ou culpabiliser).</p>
  </div>

  <!-- Tabs -->
  <div data-controller="tabs">
    <div class="mb-6 border-b border-gray-200">
      <nav class="flex space-x-8 justify-center" aria-label="Tabs">
        <button
          type="button"
          data-tabs-target="tab"
          data-action="click->tabs#switch"
          data-tab="all"
          class="py-4 px-1 border-b-2 border-asmbv-red font-medium text-sm text-asmbv-red"
        >
          Tous
        </button>
        <button
          type="button"
          data-tabs-target="tab"
          data-action="click->tabs#switch"
          data-tab="groups"
          class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300"
        >
          Par groupe
        </button>
      </nav>
    </div>

    <!-- Tab Content: All -->
    <div data-tabs-target="panel" data-panel="all" class="tab-panel">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      <!-- Section A: Records all-time -->
      <div class="space-y-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Records all-time (tous types de sessions)</h2>
        
        <%= render PodiumComponent.new(
          players: @stats[:all_time][:male],
          title: "Le sable lui dit bonjour",
          icon: "home"
        ) %>

        <%= render PodiumComponent.new(
          players: @stats[:all_time][:female],
          title: "Le sable, c'est sa résidence principale",
          icon: "home"
        ) %>
      </div>

      <!-- Section B: Jeu libre -->
      <div class="space-y-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Jeu libre (semaine / mois)</h2>
        
        <div class="space-y-4">
          <div class="flex items-center gap-3 my-4">
            <div class="flex-1 border-t border-gray-300"></div>
            <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Cette semaine</span>
            <div class="flex-1 border-t border-gray-300"></div>
          </div>
          
          <%= render PodiumComponent.new(
            players: @stats[:free_play_week][:male],
            title: "C'est pas une addiction, c'est un mode de vie",
            icon: "activity"
          ) %>

          <%= render PodiumComponent.new(
            players: @stats[:free_play_week][:female],
            title: "C'est pas une addiction, c'est un mode de vie",
            icon: "activity"
          ) %>
        </div>

        <div class="space-y-4">
          <div class="flex items-center gap-3 my-4">
            <div class="flex-1 border-t border-gray-300"></div>
            <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Ce mois</span>
            <div class="flex-1 border-t border-gray-300"></div>
          </div>
          
          <%= render PodiumComponent.new(
            players: @stats[:free_play_month][:male],
            title: "Est en CDI à la turbie",
            icon: "file-text"
          ) %>

          <%= render PodiumComponent.new(
            players: @stats[:free_play_month][:female],
            title: "Est en CDI à la turbie",
            icon: "file-text"
          ) %>
        </div>
      </div>

      <!-- Section C: Entraînement -->
      <div class="space-y-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Entraînement (semaine / mois)</h2>
        
        <div class="space-y-4">
          <div class="flex items-center gap-3 my-4">
            <div class="flex-1 border-t border-gray-300"></div>
            <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Cette semaine</span>
            <div class="flex-1 border-t border-gray-300"></div>
          </div>
          
          <%= render PodiumComponent.new(
            players: @stats[:training_week][:male],
            title: "Élève modèle (cette semaine)",
            icon: "book-open"
          ) %>

          <%= render PodiumComponent.new(
            players: @stats[:training_week][:female],
            title: "Élève modèle (cette semaine)",
            icon: "book-open"
          ) %>
        </div>

        <div class="space-y-4">
          <div class="flex items-center gap-3 my-4">
            <div class="flex-1 border-t border-gray-300"></div>
            <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Ce mois</span>
            <div class="flex-1 border-t border-gray-300"></div>
          </div>
          
          <%= render PodiumComponent.new(
            players: @stats[:training_month][:male],
            title: "Major de promo (ce mois-ci)",
            icon: "graduation-cap"
          ) %>

          <%= render PodiumComponent.new(
            players: @stats[:training_month][:female],
            title: "Major de promo (ce mois-ci)",
            icon: "graduation-cap"
          ) %>
        </div>
      </div>

      <!-- Section D: Inactivité -->
      <div class="space-y-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Le frigo (inactivité)</h2>
        
        <%= render PodiumComponent.new(
          players: @stats[:inactivity][:male],
          title: "Porté disparu",
          icon: "snowflake",
          empty_message: "Aucune donnée"
        ) %>

        <%= render PodiumComponent.new(
          players: @stats[:inactivity][:female],
          title: "Portée disparue",
          icon: "snowflake",
          empty_message: "Aucune donnée"
        ) %>
      </div>
    </div>
    </div>

    <!-- Tab Content: By Group -->
    <div data-tabs-target="panel" data-panel="groups" class="tab-panel hidden">
    <% if @stats_by_group.any? %>
      <!-- Group Tabs -->
      <div data-controller="group-tabs" class="mb-8">
        <div class="border-b border-gray-200">
          <nav class="flex space-x-4 overflow-x-auto pb-px" aria-label="Group Tabs">
            <% @stats_by_group.each_with_index do |(level_id, group_stats), index| %>
              <button
                type="button"
                data-group-tabs-target="tab"
                data-action="click->group-tabs#switch"
                data-group="<%= level_id %>"
                data-level-color="<%= group_stats[:level].color %>"
                class="group-tab-button py-3 px-4 border-b-2 font-medium text-sm whitespace-nowrap transition-colors hover:opacity-80 <%= index == 0 ? 'active' : '' %>"
                style="<%= index == 0 ? "border-color: #{group_stats[:level].color}; color: #{group_stats[:level].color};" : "border-color: transparent; color: #6b7280;" %>"
              >
                <%= level_badge(group_stats[:level]) %>
                <span class="ml-2"><%= group_stats[:level_name] %></span>
              </button>
            <% end %>
          </nav>
        </div>

        <!-- Group Content -->
        <% @stats_by_group.each_with_index do |(level_id, group_stats), index| %>
          <div
            data-group-tabs-target="panel"
            data-group="<%= level_id %>"
            class="group-panel <%= index == 0 ? '' : 'hidden' %>"
          >
            <div class="mt-8">
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Records all-time -->
            <div class="space-y-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">Records all-time</h3>
              <%= render PodiumComponent.new(
                players: group_stats[:all_time][:players],
                title: "Le sable lui dit bonjour",
                icon: "home"
              ) %>
            </div>

            <!-- Jeu libre -->
            <div class="space-y-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">Jeu libre</h3>
              
              <div class="space-y-4">
                <div class="flex items-center gap-3 my-4">
                  <div class="flex-1 border-t border-gray-300"></div>
                  <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Cette semaine</span>
                  <div class="flex-1 border-t border-gray-300"></div>
                </div>
                
                <%= render PodiumComponent.new(
                  players: group_stats[:free_play_week][:players],
                  title: "C'est pas une addiction, c'est un mode de vie",
                  icon: "activity"
                ) %>
              </div>

              <div class="space-y-4">
                <div class="flex items-center gap-3 my-4">
                  <div class="flex-1 border-t border-gray-300"></div>
                  <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Ce mois</span>
                  <div class="flex-1 border-t border-gray-300"></div>
                </div>
                
                <%= render PodiumComponent.new(
                  players: group_stats[:free_play_month][:players],
                  title: "Est en CDI à la turbie",
                  icon: "file-text"
                ) %>
              </div>
            </div>

            <!-- Entraînement -->
            <div class="space-y-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">Entraînement</h3>
              
              <div class="space-y-4">
                <div class="flex items-center gap-3 my-4">
                  <div class="flex-1 border-t border-gray-300"></div>
                  <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Cette semaine</span>
                  <div class="flex-1 border-t border-gray-300"></div>
                </div>
                
                <%= render PodiumComponent.new(
                  players: group_stats[:training_week][:players],
                  title: "Élève modèle (cette semaine)",
                  icon: "book-open"
                ) %>
              </div>

              <div class="space-y-4">
                <div class="flex items-center gap-3 my-4">
                  <div class="flex-1 border-t border-gray-300"></div>
                  <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">Ce mois</span>
                  <div class="flex-1 border-t border-gray-300"></div>
                </div>
                
                <%= render PodiumComponent.new(
                  players: group_stats[:training_month][:players],
                  title: "Major de promo (ce mois-ci)",
                  icon: "graduation-cap"
                ) %>
              </div>
            </div>

            <!-- Inactivité -->
            <div class="space-y-6">
              <h3 class="text-lg font-semibold text-gray-800 mb-4">Le frigo</h3>
              <%= render PodiumComponent.new(
                players: group_stats[:inactivity][:players],
                title: "Porté(e) disparu(e)",
                icon: "snowflake",
                empty_message: "Aucune donnée"
              ) %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-12">
        <p class="text-gray-400 italic">Aucun groupe disponible</p>
      </div>
    <% end %>
    </div>
  </div>
</div>
